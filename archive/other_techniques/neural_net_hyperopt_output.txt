üèí Training Neural Network with Hyperparameter Optimization

Loading training data...
  Dataset: 4426 games, 98 features
  Home win rate: 53.8%

Train: 3098 | Val: 664 | Test: 664

Using device: cuda
GPU: NVIDIA GeForce RTX 3090

============================================================
HYPERPARAMETER OPTIMIZATION (30 trials)
============================================================

============================================================
Trial 1/30
============================================================
Hyperparameters: Hidden=[208, 64, 32], Dropout=0.192, LR=0.000132, WD=0.000011, BS=128
Train AUC: 0.5010, Val AUC: 0.6287, Loss: 0.4990

============================================================
Trial 2/30
============================================================
Hyperparameters: Hidden=[176, 96, 24], Dropout=0.218, LR=0.000647, WD=0.000097, BS=32
Train AUC: 0.4998, Val AUC: 0.6152, Loss: 0.5002

============================================================
Trial 3/30
============================================================
Hyperparameters: Hidden=[192, 112, 56], Dropout=0.378, LR=0.000183, WD=0.000132, BS=128
Train AUC: 0.4894, Val AUC: 0.6346, Loss: 0.5106

============================================================
Trial 4/30
============================================================
Hyperparameters: Hidden=[160, 80, 16], Dropout=0.279, LR=0.000495, WD=0.000587, BS=64
Train AUC: 0.4960, Val AUC: 0.6331, Loss: 0.5040

============================================================
Trial 5/30
============================================================
Hyperparameters: Hidden=[240, 64, 56], Dropout=0.384, LR=0.000900, WD=0.000215, BS=32
Train AUC: 0.4768, Val AUC: 0.6214, Loss: 0.5232

============================================================
Trial 6/30
============================================================
Hyperparameters: Hidden=[144, 48, 24], Dropout=0.291, LR=0.006379, WD=0.000034, BS=32
Train AUC: 0.4977, Val AUC: 0.6080, Loss: 0.5023

============================================================
Trial 7/30
============================================================
Hyperparameters: Hidden=[128, 112, 40], Dropout=0.244, LR=0.000408, WD=0.000372, BS=32
Train AUC: 0.4971, Val AUC: 0.6077, Loss: 0.5029

============================================================
Trial 8/30
============================================================
Hyperparameters: Hidden=[96, 80, 64], Dropout=0.224, LR=0.000151, WD=0.000003, BS=64
Train AUC: 0.5035, Val AUC: 0.6317, Loss: 0.4965

============================================================
Trial 9/30
============================================================
Hyperparameters: Hidden=[128, 80, 32], Dropout=0.163, LR=0.006308, WD=0.000181, BS=64
Train AUC: 0.4899, Val AUC: 0.5934, Loss: 0.5101

============================================================
Trial 10/30
============================================================
Hyperparameters: Hidden=[80, 112, 48], Dropout=0.253, LR=0.000165, WD=0.000948, BS=128
Train AUC: 0.4997, Val AUC: 0.6241, Loss: 0.5003

============================================================
Trial 11/30
============================================================
Hyperparameters: Hidden=[224, 128, 40], Dropout=0.377, LR=0.005847, WD=0.000047, BS=128
Train AUC: 0.5144, Val AUC: 0.6164, Loss: 0.4856

============================================================
Trial 12/30
============================================================
Hyperparameters: Hidden=[176, 112, 64], Dropout=0.119, LR=0.000525, WD=0.000003, BS=32
Train AUC: 0.4940, Val AUC: 0.5820, Loss: 0.5060

============================================================
Trial 13/30
============================================================
Hyperparameters: Hidden=[96, 128, 48], Dropout=0.183, LR=0.000252, WD=0.000020, BS=128
Train AUC: 0.4982, Val AUC: 0.6375, Loss: 0.5018

============================================================
Trial 14/30
============================================================
Hyperparameters: Hidden=[112, 32, 16], Dropout=0.410, LR=0.004677, WD=0.000004, BS=64
Train AUC: 0.4931, Val AUC: 0.6169, Loss: 0.5069

============================================================
Trial 15/30
============================================================
Hyperparameters: Hidden=[208, 112, 24], Dropout=0.315, LR=0.009079, WD=0.000351, BS=32
Train AUC: 0.4968, Val AUC: 0.6446, Loss: 0.5032

============================================================
Trial 16/30
============================================================
Hyperparameters: Hidden=[112, 80, 48], Dropout=0.245, LR=0.000218, WD=0.000001, BS=64
Train AUC: 0.4943, Val AUC: 0.6217, Loss: 0.5057

============================================================
Trial 17/30
============================================================
Hyperparameters: Hidden=[224, 32, 32], Dropout=0.123, LR=0.002346, WD=0.000123, BS=64
Train AUC: 0.4987, Val AUC: 0.5649, Loss: 0.5013

============================================================
Trial 18/30
============================================================
Hyperparameters: Hidden=[224, 112, 24], Dropout=0.341, LR=0.000224, WD=0.000001, BS=64
Train AUC: 0.4956, Val AUC: 0.6311, Loss: 0.5044

============================================================
Trial 19/30
============================================================
Hyperparameters: Hidden=[144, 64, 40], Dropout=0.385, LR=0.000821, WD=0.000012, BS=32
Train AUC: 0.4935, Val AUC: 0.6264, Loss: 0.5065

============================================================
Trial 20/30
============================================================
Hyperparameters: Hidden=[128, 32, 32], Dropout=0.288, LR=0.000528, WD=0.000001, BS=128
Train AUC: 0.5083, Val AUC: 0.6315, Loss: 0.4917

============================================================
Trial 21/30
============================================================
Hyperparameters: Hidden=[64, 128, 40], Dropout=0.483, LR=0.001571, WD=0.000045, BS=128
Train AUC: 0.4913, Val AUC: 0.6337, Loss: 0.5087

============================================================
Trial 22/30
============================================================
Hyperparameters: Hidden=[256, 48, 32], Dropout=0.466, LR=0.002487, WD=0.000062, BS=128
Train AUC: 0.4767, Val AUC: 0.6273, Loss: 0.5233

============================================================
Trial 23/30
============================================================
Hyperparameters: Hidden=[256, 96, 40], Dropout=0.336, LR=0.001414, WD=0.000006, BS=128
Train AUC: 0.5097, Val AUC: 0.6180, Loss: 0.4903

============================================================
Trial 24/30
============================================================
Hyperparameters: Hidden=[256, 96, 48], Dropout=0.421, LR=0.001546, WD=0.000006, BS=128
Train AUC: 0.4903, Val AUC: 0.6307, Loss: 0.5097

============================================================
Trial 25/30
============================================================
Hyperparameters: Hidden=[240, 96, 56], Dropout=0.336, LR=0.003510, WD=0.000016, BS=128
Train AUC: 0.5065, Val AUC: 0.6058, Loss: 0.4935

============================================================
Trial 26/30
============================================================
Hyperparameters: Hidden=[240, 128, 40], Dropout=0.449, LR=0.001466, WD=0.000024, BS=128
Train AUC: 0.5023, Val AUC: 0.6293, Loss: 0.4977

============================================================
Trial 27/30
============================================================
Hyperparameters: Hidden=[208, 96, 48], Dropout=0.352, LR=0.003066, WD=0.000007, BS=128
Train AUC: 0.4961, Val AUC: 0.6021, Loss: 0.5039

============================================================
Trial 28/30
============================================================
Hyperparameters: Hidden=[224, 128, 40], Dropout=0.498, LR=0.007587, WD=0.000002, BS=128
Train AUC: 0.4937, Val AUC: 0.6244, Loss: 0.5063

============================================================
Trial 29/30
============================================================
Hyperparameters: Hidden=[192, 64, 32], Dropout=0.424, LR=0.001184, WD=0.000007, BS=128
Train AUC: 0.4958, Val AUC: 0.6342, Loss: 0.5042

============================================================
Trial 30/30
============================================================
Hyperparameters: Hidden=[208, 96, 56], Dropout=0.359, LR=0.004699, WD=0.000067, BS=128
Train AUC: 0.4883, Val AUC: 0.5967, Loss: 0.5117

============================================================
üéØ BEST HYPERPARAMETERS
============================================================
  hidden_1: 224
  hidden_2: 128
  hidden_3: 40
  dropout: 0.376848
  lr: 0.005847
  weight_decay: 0.000047
  batch_size: 128

  Best Val AUC: 0.6164
  Train AUC: 0.5144
  Overfit: 0.1021

============================================================
TRAINING FINAL MODEL
============================================================


============================================================
üìä FINAL MODEL PERFORMANCE
============================================================
  Train AUC: 0.4974
  Val AUC:   0.5836
  Test AUC:  0.5549
  Overfit:   -0.0862

  Test Accuracy: 0.5587
  Baseline:      0.5120
  Improvement:   0.0467

  Training time: 1.7s

Classification Report:
              precision    recall  f1-score   support

    Away Win       0.55      0.49      0.52       324
    Home Win       0.56      0.63      0.59       340

    accuracy                           0.56       664
   macro avg       0.56      0.56      0.56       664
weighted avg       0.56      0.56      0.56       664


‚úÖ Model saved to /mnt/data2/nhlstats/other_techniques/neural_net_hyperopt_model.pt
‚úÖ Results saved to /mnt/data2/nhlstats/other_techniques/neural_net_hyperopt_results.json
